<translate-icon class="ms-2 sm:ms-4">
	<button
		class="hover:text-accent relative mb-1.5 h-9 w-9 cursor-pointer rounded-md p-2"
		type="button"
		aria-label="Toggle language"
	>
		<span class="sr-only">Translate</span>
		<svg
			aria-hidden="true"
			class="h-7 w-7"
			fill="none"
			focusable="false"
			stroke="currentColor"
			stroke-width="1.5"
			stroke-linecap="round"
			stroke-linejoin="round"
			viewBox="0 0 25 25"
			xmlns="http://www.w3.org/2000/svg"
		>
			<circle cx="12" cy="12" r="10"></circle>
			<path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"></path>
			<path d="M2 12h20"></path>
		</svg>
	</button>
</translate-icon>

<script>
	class TranslateIcon extends HTMLElement {
		connectedCallback() {
			const button = this.querySelector("button");
			button?.addEventListener("click", () => {
				let currentPath = window.location.pathname;

				// Handle root path
				if (currentPath === "/") {
					window.location.href = "/eng/";
					return;
				}

				// Handle /eng path
				if (currentPath === "/eng" || currentPath === "/eng/") {
					window.location.href = "/";
					return;
				}

				// Remove trailing slash if present for consistent handling
				let normalizedPath =
					currentPath.endsWith("/") && currentPath.length > 1
						? currentPath.slice(0, -1)
						: currentPath;

				let newPath: string;

				if (normalizedPath.endsWith("/eng")) {
					// Remove /eng suffix and add trailing slash
					newPath = normalizedPath.slice(0, -4) + "/";
				} else {
					// Add /eng suffix with trailing slash
					newPath = normalizedPath + "/eng/";
				}

				// Ensure path starts with /
				if (!newPath.startsWith("/")) {
					newPath = "/" + newPath;
				}

				window.location.href = newPath;
			});
		}
	}

	customElements.define("translate-icon", TranslateIcon);
</script>
