---
interface Props {
	post_id: string;
}
const { post_id } = Astro.props;
---

<form class="mb-16 mt-8 text-xl font-bold">
	<input type="hidden" name="post_id" value={post_id} />
  <!-- <div class="mb-4">
    <label for="name" class="block  text-gray-700"
      >Name</label
    >
    <input
      type="text"
      id="name"
      name="name"
      class="my-4  block w-full h-10 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 "
      required
    />
  </div> -->
  <div class="mb-4">
    <!-- <label for="comment" class="block  text-gray-700 text-sm">Comment</label> -->
    <textarea
      
      id="comment"
      name="comment"
      rows="4"
      class=" my-4 p-4 block text-2xl font-bold w-full h-64 rounded-md border-gray-300 shadow-sm focus:border-accent focus:ring-accent "
      required></textarea>
  </div>
  <button
    type="submit"
    class="my-4 inline-flex items-center rounded-md border border-transparent bg-accent px-4 py-2 text-white shadow-sm hover:bg-accent/80 focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2"
  >
    Submit
  </button>
</form>

<style>
  textarea {
    border-color: var(--color-accent);
    background-color: var(--color-bg);
    color: var(--color-text);
    border: 1px solid var(--color-border);
    box-shadow: 0 0 0 1px var(--color-accent);

  }
  textarea:focus {
    box-shadow: 0 0 0 2px var(--color-accent);
    outline: none;
  }
</style>

<script>
  document.querySelector("form")?.addEventListener("submit", (e) => {
    e.preventDefault();
    const form = e.target as HTMLFormElement;
    const formData = new FormData(form);
    const name = formData.get("name") as string;
    const comment = formData.get("comment") as string;
  const postId = formData.get("post_id") as string;

  console.log("Submitting comment for post_id:", postId); // You can see this in the browser console

  if (comment) {
   const event = new CustomEvent("new-comment", {
    bubbles: true,
    detail: { author: name, content: comment, date: new Date(), postId },
   });
      form.dispatchEvent(event);
      form.reset();
    }
  });
</script>