---
import { type CollectionEntry, getCollection } from "astro:content";
import PageLayout from "@/layouts/Base.astro";
import { render } from "astro:content";

export async function getStaticPaths() {
	const projects = await getCollection("project");
	return projects.map((project) => ({
		params: { slug: project.id },
		props: { project },
	}));
}

interface Props {
	project: CollectionEntry<"project">;
}

const { project } = Astro.props;
const { Content } = await render(project);

const meta = {
	description: project.data.description,
	title: project.data.title,
};
---

<PageLayout meta={meta}>
	<article>
		<h1 class="title mb-4">{project.data.title}</h1>
		<p class="mb-6 text-lg text-gray-600 dark:text-gray-400">{project.data.description}</p>

		{
			project.data.techStack && project.data.techStack.length > 0 && (
				<div class="mb-6">
					<h2 class="mb-2 text-sm font-semibold text-gray-500 dark:text-gray-400">Tech Stack</h2>
					<ul class="flex flex-wrap gap-2">
						{project.data.techStack.map((tech) => (
							<li class="rounded-full bg-gray-100 px-3 py-1 text-sm text-gray-700 dark:bg-gray-800 dark:text-gray-300">
								{tech}
							</li>
						))}
					</ul>
				</div>
			)
		}

		<div class="prose dark:prose-invert max-w-none">
			<Content />
		</div>

		<div class="mt-8 flex gap-4">
			{
				project.data.githubUrl && (
					<a
						href={project.data.githubUrl}
						target="_blank"
						rel="noopener noreferrer"
						class="rounded-lg bg-gray-100 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"
					>
						View on GitHub
					</a>
				)
			}
			{
				project.data.demoUrl && (
					<a
						href={project.data.demoUrl}
						target="_blank"
						rel="noopener noreferrer"
						class="bg-accent hover:bg-accent/80 rounded-lg px-4 py-2 text-sm font-medium text-white"
					>
						Live Demo
					</a>
				)
			}
		</div>
	</article>
</PageLayout>
